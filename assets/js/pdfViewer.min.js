(function(b){var a={init:function(){canvas=b("#pdfViewer_"+activeID)[0];ctx=canvas.getContext("2d");url="/"+b("#pdfViewer_"+activeID).data("src");b(loader).appendTo(".pdfViewer-wrapper_"+activeID);PDFJS.getDocument(url).then(function(c){pdfDoc=c;b("#pageCount_"+activeID)[0].textContent=pdfDoc.numPages;a.renderPage(pageNum);b(document).find("#loader").remove();b("#pdfViewer_"+activeID).addClass("loaded")});a.registerEvents()},renderPage:function(c){pageRendering=true;pdfDoc.getPage(c).then(function(g){var d=g.getViewport(scale);canvas.height=d.height;canvas.width=d.width;var f={canvasContext:ctx,viewport:d};var e=g.render(f);e.promise.then(function(){pageRendering=false;if(pageNumPending!==null){a.renderPage(pageNumPending);pageNumPending=null}})});b("#ctrl-pageNum_"+activeID)[0].textContent=pageNum},queueRenderPage:function(c){if(pageRendering){pageNumPending=c}else{a.renderPage(c)}a.updatePageNum(c)},onPrevPage:function(){if(pageNum<=1){return}pageNum--;a.queueRenderPage(pageNum)},onNextPage:function(){if(pageNum>=pdfDoc.numPages){return}pageNum++;a.queueRenderPage(pageNum)},updatePageNum:function(c){b("#ctrl-pageNum_"+activeID).val(c)},registerEvents:function(){b(document).keydown(function(c){if(c.which==13){c.preventDefault();pageNum=parseInt(b("#ctrl-pageNum_"+activeID).val());if(b("#ctrl-pageNum_"+activeID+":focus").length&&pageNum<=pdfDoc.numPages&&pageNum>=1){a.queueRenderPage(pageNum)}}});b("#ctrl-prev_"+activeID).on("click",function(){a.onPrevPage()});b("#ctrl-next_"+activeID).on("click",function(){a.onNextPage()});b(".tabs").on("click",function(){activeID=b(this).data("target");pageNum=parseInt(b("#ctrl-pageNum_"+activeID).val());if(!b("#pdfViewer_"+activeID).hasClass("loaded")){a.init()}})}};b(document).ready(function(){a.init()})})(jQuery);